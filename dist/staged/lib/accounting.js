(function(a,b){function g(a){return!!(a===""||a&&a.charCodeAt&&a.substr)}function h(a){return e?e(a):f.call(a)==="[object Array]"}function i(a){return f.call(a)==="[object Object]"}function j(a,b){var c;for(c in b)b.hasOwnProperty(c)&&a[c]==null&&(a[c]=b[c]);return a}function k(a,b,c){var e=[],f,g;if(!a)return e;if(d&&a.map===d)return a.map(b,c);for(f=0,g=a.length;f<g;f++)e[f]=b.call(c,a[f],f,a);return e}function l(a,b){return a=Math.round(Math.abs(a)),isNaN(a)?b:a}function m(a){var b=c.settings.currency.format;return typeof a=="function"&&(a=a()),g(a)&&a.match("%v")?{pos:a,neg:a.replace("-","").replace("%v","-%v"),zero:a}:!a||!a.pos||!a.pos.match("%v")?g(b)?c.settings.currency.format={pos:b,neg:b.replace("%v","-%v"),zero:b}:b:a}var c={};c.version="0.3-alpha",c.settings={currency:{symbol:"$",format:"%s%v",decimal:".",thousand:",",precision:2,grouping:3},number:{precision:0,grouping:3,thousand:",",decimal:"."}};var d=Array.prototype.map,e=Array.isArray,f=Object.prototype.toString,n=c.unformat=function(a,b){if(h(a))return k(a,function(a){return n(a,b)});a=a||0,b=b||".";var c=new RegExp("[^0-9-"+b+"]",["g"]),d=parseFloat((""+a).replace(c,"").replace(b,"."));return isNaN(d)?0:d},o=c.toFixed=function(a,b){b=l(b,c.settings.number.precision);var d=Math.pow(10,b);return(Math.round(a*d)/d).toFixed(b)},p=c.formatNumber=function(a,b,d,e){if(h(a))return k(a,function(a){return p(a,b,d,e)});a=n(a);var f=j(i(b)?b:{precision:b,thousand:d,decimal:e},c.settings.number),g=l(f.precision),m=a<0?"-":"",q=parseInt(o(Math.abs(a||0),g),10)+"",r=q.length>3?q.length%3:0;return m+(r?q.substr(0,r)+f.thousand:"")+q.substr(r).replace(/(\d{3})(?=\d)/g,"$1"+f.thousand)+(g?f.decimal+o(Math.abs(a),g).split(".")[1]:"")},q=c.formatMoney=function(a,b,d,e,f,g){if(h(a))return k(a,function(a){return q(a,b,d,e,f,g)});a=n(a);var o=j(i(b)?b:{symbol:b,precision:d,thousand:e,decimal:f,format:g},c.settings.currency),r=m(o.format),s=a>0?r.pos:a<0?r.neg:r.zero;return s.replace("%s",o.symbol).replace("%v",p(Math.abs(a),l(o.precision),o.thousand,o.decimal))};c.formatColumn=function(a,b,d,e,f,o){if(!a)return[];var q=j(i(b)?b:{symbol:b,precision:d,thousand:e,decimal:f,format:o},c.settings.currency),r=m(q.format),s=r.pos.indexOf("%s")<r.pos.indexOf("%v")?!0:!1,t=0,u=k(a,function(a,b){if(h(a))return c.formatColumn(a,q);a=n(a);var d=a>0?r.pos:a<0?r.neg:r.zero,e=d.replace("%s",q.symbol).replace("%v",p(Math.abs(a),l(q.precision),q.thousand,q.decimal));return e.length>t&&(t=e.length),e});return k(u,function(a,b){return g(a)&&a.length<t?s?a.replace(q.symbol,q.symbol+(new Array(t-a.length+1)).join(" ")):(new Array(t-a.length+1)).join(" ")+a:a})},typeof module!="undefined"&&module.exports?(module.exports=c,c.accounting=c):typeof define=="function"&&define.amd?define([],function(){return c}):(c.noConflict=function(d){return function(){return a.accounting=d,c.noConflict=b,c}}(a.accounting),a.accounting=c)})(this)