define([],function(){var a={},b=-1,c={},d=function(b,c,d){if(!a.hasOwnProperty(b))return!1;var e=function(){var d=a[b],e=function(a){return function(){throw a}};for(var f=0,g=d.length;f<g;f++)try{d[f].func(b,c)}catch(h){setTimeout(e(h),0)}};return d===!0?e():setTimeout(e,0),!0};return c.version="0.1",c.publish=function(a,b){return d(a,b,!1)},c.publishSync=function(a,b){return d(a,b,!0)},c.subscribe=function(c,d){a.hasOwnProperty(c)||(a[c]=[]);var e=(++b).toString();return a[c].push({token:e,func:d}),e},c.unsubscribe=function(b){for(var c in a)if(a.hasOwnProperty(c))for(var d=0,e=a[c].length;d<e;d++)if(a[c][d].token===b)return a[c].splice(d,1),b;return!1},c})