// Knockout Mapping plugin v1.2.5
// (c) 2011 Steven Sanderson, Roy Jacobs - http://knockoutjs.com/
// License: Ms-Pl (http://www.opensource.org/licenses/ms-pl.html)

ko.exportSymbol=function(h,p){for(var k=h.split("."),m=window,i=0;i<k.length-1;i++)m=m[k[i]];m[k[k.length-1]]=p};ko.exportProperty=function(h,p,k){h[p]=k};
(function(){function h(a,c){for(var b in c)c.hasOwnProperty(b)&&c[b]&&(a[b]&&!(a[b]instanceof Array)?h(a[b],c[b]):a[b]=c[b])}function p(a,c){var b={};h(b,a);h(b,c);return b}function k(a){return a&&typeof a==="object"&&a.constructor==(new Date).constructor?"date":typeof a}function m(a,c){a=a||{};if(a.create instanceof Function||a.key instanceof Function||a.arrayChanged instanceof Function)a={"":a};if(c)a.ignore=i(c.ignore,a.ignore),a.include=i(c.include,a.include),a.copy=i(c.copy,a.copy);a.ignore=
i(a.ignore,f.ignore);a.include=i(a.include,f.include);a.copy=i(a.copy,f.copy);a.mappedProperties={};return a}function i(a,c){a instanceof Array||(a=k(a)==="undefined"?[]:[a]);c instanceof Array||(c=k(c)==="undefined"?[]:[c]);return a.concat(c)}function A(a){var c=ko.dependentObservable;ko.dependentObservable=function(a,c,d){d=d||{};a&&typeof a=="object"&&(d=a);d.deferEvaluation=!0;a=new x(a,c,d);a.__ko_proto__=x;return a};a=a();ko.dependentObservable=c;return a}function t(a,c,b,e,d,i,u){var f=ko.utils.unwrapObservable(c)instanceof
Array,u=u||"";if(ko.mapping.isMapped(a))var q=ko.utils.unwrapObservable(a)[l],b=p(q,b);var j=function(){return b[d]&&b[d].create instanceof Function},e=e||new B;if(e.get(c))return a;d=d||"";if(f){var f=[],q=!1,g=function(a){return a};if(b[d]&&b[d].key)g=b[d].key,q=!0;var m=function(a){return a};j()&&(m=function(a){return b[d].create({data:a,parent:i})});if(!ko.isObservable(a))a=ko.observableArray([]),a.mappedRemove=function(b){var c=typeof b=="function"?b:function(a){return a===g(b)};return a.remove(function(a){return c(g(a))})},
a.mappedRemoveAll=function(b){var c=v(b,g);return a.remove(function(a){return ko.utils.arrayIndexOf(c,g(a))!=-1})},a.mappedDestroy=function(b){var c=typeof b=="function"?b:function(a){return a===g(b)};return a.destroy(function(a){return c(g(a))})},a.mappedDestroyAll=function(b){var c=v(b,g);return a.destroy(function(a){return ko.utils.arrayIndexOf(c,g(a))!=-1})},a.mappedIndexOf=function(b){var c=v(a(),g),b=g(b);return ko.utils.arrayIndexOf(c,b)},a.mappedCreate=function(b){if(a.mappedIndexOf(b)!==
-1)throw Error("There already is an object with the key that you specified.");b=m(b);a.push(b);return b};var j=v(ko.utils.unwrapObservable(a),g).sort(),h=v(c,g);q&&h.sort();for(var q=ko.utils.compareArrays(j,h),j={},h=[],n=0,x=q.length;n<x;n++){var s=q[n],r,o=u+"["+n+"]";switch(s.status){case "added":var w=y(ko.utils.unwrapObservable(c),s.value,g);r=ko.utils.unwrapObservable(t(void 0,w,b,e,d,a,o));o=C(ko.utils.unwrapObservable(c),w,j);h[o]=r;j[o]=!0;break;case "retained":w=y(ko.utils.unwrapObservable(c),
s.value,g);r=y(a,s.value,g);t(r,w,b,e,d,a,o);o=C(ko.utils.unwrapObservable(c),w,j);h[o]=r;j[o]=!0;break;case "deleted":r=y(a,s.value,g)}f.push({event:s.status,item:r})}a(h);b[d]&&b[d].arrayChanged&&ko.utils.arrayForEach(f,function(a){b[d].arrayChanged(a.event,a.item)})}else if(z(c)){if(!a)if(j())return A(function(){return b[d].create({data:c,parent:i})});else a={};e.save(c,a);D(c,function(d){var g=u.length?u+"."+d:d;if(ko.utils.arrayIndexOf(b.ignore,g)==-1)if(ko.utils.arrayIndexOf(b.copy,g)!=-1)a[d]=
c[d];else{var f=e.get(c[d]);a[d]=f?f:t(a[d],c[d],b,e,d,a,g);b.mappedProperties[g]=!0}})}else switch(k(c)){case "function":a=c;break;default:ko.isWriteableObservable(a)?a(ko.utils.unwrapObservable(c)):a=j()?A(function(){return b[d].create({data:c,parent:i})}):ko.observable(ko.utils.unwrapObservable(c))}return a}function C(a,c,b){for(var e=0,d=a.length;e<d;e++)if(b[e]!==!0&&a[e]==c)return e;return null}function E(a,c){var b;c&&(b=c(a));k(b)==="undefined"&&(b=a);return ko.utils.unwrapObservable(b)}function y(a,
c,b){a=ko.utils.arrayFilter(ko.utils.unwrapObservable(a),function(a){return E(a,b)===c});if(a.length==0)throw Error("When calling ko.update*, the key '"+c+"' was not found!");if(a.length>1&&z(a[0]))throw Error("When calling ko.update*, the key '"+c+"' was not unique!");return a[0]}function v(a,c){return ko.utils.arrayMap(ko.utils.unwrapObservable(a),function(a){return c?E(a,c):a})}function D(a,c){if(a instanceof Array)for(var b=0;b<a.length;b++)c(b);else for(b in a)c(b)}function z(a){var c=k(a);return c==
"object"&&a!==null&&c!=="undefined"}function B(){var a=[],c=[];this.save=function(b,e){var d=ko.utils.arrayIndexOf(a,b);d>=0?c[d]=e:(a.push(b),c.push(e))};this.get=function(b){b=ko.utils.arrayIndexOf(a,b);return b>=0?c[b]:void 0}}ko.mapping={};var l="__ko_mapping__",x=ko.dependentObservable,n={include:["_destroy"],ignore:[],copy:[]},f=n;ko.mapping.fromJS=function(a,c,b){if(arguments.length==0)throw Error("When calling ko.fromJS, pass the object you want to convert.");var c=m(c),e=t(b,a,c);e[l]=p(e[l],
c);return e};ko.mapping.fromJSON=function(a,c){var b=ko.utils.parseJson(a);return ko.mapping.fromJS(b,c)};ko.mapping.isMapped=function(a){return(a=ko.utils.unwrapObservable(a))&&a[l]};ko.mapping.updateFromJS=function(a){if(arguments.length<2||arguments.length>3)throw Error("When calling ko.updateFromJS, pass: the object to update and the object you want to update from.");if(!a)throw Error("The object is undefined.");var c,b;arguments.length==2?(c=arguments[1],b=a[l]):(b=arguments[1],c=arguments[2],
a[l]&&(b=p(a[l],b)),a[l]=b);b=m(b);return t(a,c,b)};ko.mapping.updateFromJSON=function(a){if(arguments.length<2||arguments.length>3)throw Error("When calling ko.updateFromJSON, pass: the object to update and the JSON string you want to update from.");return arguments.length==2?ko.mapping.updateFromJS(a,ko.utils.parseJson(arguments[1])):ko.mapping.updateFromJS(a,arguments[1],ko.utils.parseJson(arguments[2]))};ko.mapping.toJS=function(a,c){f||ko.mapping.resetDefaultOptions();if(arguments.length==0)throw Error("When calling ko.mapping.toJS, pass the object you want to convert.");
if(!(f.ignore instanceof Array))throw Error("ko.mapping.defaultOptions().ignore should be an array.");if(!(f.include instanceof Array))throw Error("ko.mapping.defaultOptions().include should be an array.");if(!(f.copy instanceof Array))throw Error("ko.mapping.defaultOptions().copy should be an array.");c=m(c,a[l]);return ko.mapping.visitModel(a,function(a){return ko.utils.unwrapObservable(a)},c)};ko.mapping.toJSON=function(a,c){var b=ko.mapping.toJS(a,c);return ko.utils.stringifyJson(b)};ko.mapping.defaultOptions=
function(){if(arguments.length>0)f=arguments[0];else return f};ko.mapping.resetDefaultOptions=function(){f={include:n.include.slice(0),ignore:n.ignore.slice(0),copy:n.copy.slice(0)}};ko.mapping.visitModel=function(a,c,b){b=b||{};b.visitedObjects=b.visitedObjects||new B;b.parentName||(b=m(b));var e,d=ko.utils.unwrapObservable(a);if(z(d))c(a,b.parentName),e=d instanceof Array?[]:{};else return c(a,b.parentName);b.visitedObjects.save(a,e);var f=b.parentName;D(d,function(a){if(!(b.ignore&&ko.utils.arrayIndexOf(b.ignore,
a)!=-1)){var h=d[a],i=b,j=f||"";d instanceof Array?f&&(j+="["+a+"]"):(f&&(j+="."),j+=a);i.parentName=j;if(!(ko.utils.arrayIndexOf(b.copy,a)===-1&&ko.utils.arrayIndexOf(b.include,a)===-1&&d[l]&&d[l].mappedProperties&&!d[l].mappedProperties[a]&&!(d instanceof Array)))switch(k(ko.utils.unwrapObservable(h))){case "object":case "undefined":i=b.visitedObjects.get(h);e[a]=k(i)!=="undefined"?i:ko.mapping.visitModel(h,c,b);break;default:e[a]=c(h,b.parentName)}}});return e};ko.exportSymbol("ko.mapping",ko.mapping);
ko.exportSymbol("ko.mapping.fromJS",ko.mapping.fromJS);ko.exportSymbol("ko.mapping.fromJSON",ko.mapping.fromJSON);ko.exportSymbol("ko.mapping.isMapped",ko.mapping.isMapped);ko.exportSymbol("ko.mapping.defaultOptions",ko.mapping.defaultOptions);ko.exportSymbol("ko.mapping.toJS",ko.mapping.toJS);ko.exportSymbol("ko.mapping.toJSON",ko.mapping.toJSON);ko.exportSymbol("ko.mapping.updateFromJS",ko.mapping.updateFromJS);ko.exportSymbol("ko.mapping.updateFromJSON",ko.mapping.updateFromJSON);ko.exportSymbol("ko.mapping.visitModel",
ko.mapping.visitModel)})();
